<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>10 Upwind FD SBP schemes · Trixi.jl</title><meta name="title" content="10 Upwind FD SBP schemes · Trixi.jl"/><meta property="og:title" content="10 Upwind FD SBP schemes · Trixi.jl"/><meta property="twitter:title" content="10 Upwind FD SBP schemes · Trixi.jl"/><meta name="description" content="Documentation for Trixi.jl."/><meta property="og:description" content="Documentation for Trixi.jl."/><meta property="twitter:description" content="Documentation for Trixi.jl."/><meta property="og:url" content="https://trixi-framework.github.io/Trixi.jl/stable/tutorials/upwind_fdsbp/"/><meta property="twitter:url" content="https://trixi-framework.github.io/Trixi.jl/stable/tutorials/upwind_fdsbp/"/><link rel="canonical" href="https://trixi-framework.github.io/Trixi.jl/stable/tutorials/upwind_fdsbp/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Trixi.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../overview/">Overview</a></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li><li><a class="tocitem" href="../../restart/">Restart simulation</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">1 First steps in Trixi.jl</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../first_steps/getting_started/">1.1 Getting started</a></li><li><a class="tocitem" href="../first_steps/create_first_setup/">1.2 Create your first setup</a></li><li><a class="tocitem" href="../first_steps/changing_trixi/">1.3 Changing Trixi.jl itself</a></li></ul></li><li><a class="tocitem" href="../behind_the_scenes_simulation_setup/">2 Behind the scenes of a simulation setup</a></li><li><a class="tocitem" href="../scalar_linear_advection_1d/">3 Introduction to DG methods</a></li><li><a class="tocitem" href="../DGSEM_FluxDiff/">4 DGSEM with flux differencing</a></li><li><a class="tocitem" href="../shock_capturing/">5 Shock capturing with flux differencing and stage limiter</a></li><li><a class="tocitem" href="../subcell_shock_capturing/">6 Subcell limiting with the IDP Limiter</a></li><li><a class="tocitem" href="../non_periodic_boundaries/">7 Non-periodic boundaries</a></li><li><a class="tocitem" href="../DGMulti_1/">8 DG schemes via <code>DGMulti</code> solver</a></li><li><a class="tocitem" href="../DGMulti_2/">9 Other SBP schemes (FD, CGSEM) via <code>DGMulti</code> solver</a></li><li class="is-active"><a class="tocitem" href>10 Upwind FD SBP schemes</a><ul class="internal"><li><a class="tocitem" href="#Package-versions"><span>Package versions</span></a></li></ul></li><li><a class="tocitem" href="../adding_new_scalar_equations/">11 Adding a new scalar conservation law</a></li><li><a class="tocitem" href="../adding_nonconservative_equation/">12 Adding a non-conservative equation</a></li><li><a class="tocitem" href="../parabolic_terms/">13 Parabolic terms</a></li><li><a class="tocitem" href="../adding_new_parabolic_terms/">14 Adding new parabolic terms</a></li><li><a class="tocitem" href="../adaptive_mesh_refinement/">15 Adaptive mesh refinement</a></li><li><a class="tocitem" href="../structured_mesh_mapping/">16 Structured mesh with curvilinear mapping</a></li><li><a class="tocitem" href="../hohqmesh_tutorial/">17 Unstructured meshes with HOHQMesh.jl</a></li><li><a class="tocitem" href="../p4est_from_gmsh/">18 P4est mesh from gmsh</a></li><li><a class="tocitem" href="../time_stepping/">19 Explicit time stepping</a></li><li><a class="tocitem" href="../differentiable_programming/">20 Differentiable programming</a></li><li><a class="tocitem" href="../custom_semidiscretization/">21 Custom semidiscretizations</a></li></ul></li><li><span class="tocitem">Basic building blocks</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Meshes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../meshes/tree_mesh/">Tree mesh</a></li><li><a class="tocitem" href="../../meshes/structured_mesh/">Structured mesh</a></li><li><a class="tocitem" href="../../meshes/unstructured_quad_mesh/">Unstructured mesh</a></li><li><a class="tocitem" href="../../meshes/p4est_mesh/">P4est-based mesh</a></li><li><a class="tocitem" href="../../meshes/dgmulti_mesh/">DGMulti mesh</a></li></ul></li><li><a class="tocitem" href="../../time_integration/">Time integration</a></li><li><a class="tocitem" href="../../callbacks/">Callbacks</a></li><li><a class="tocitem" href="../../multi-physics_coupling/">Coupling</a></li></ul></li><li><span class="tocitem">Advanced topics &amp; developers</span><ul><li><a class="tocitem" href="../../conventions/">Conventions</a></li><li><a class="tocitem" href="../../development/">Development</a></li><li><a class="tocitem" href="../../github-git/">GitHub &amp; Git</a></li><li><a class="tocitem" href="../../styleguide/">Style guide</a></li><li><a class="tocitem" href="../../testing/">Testing</a></li><li><a class="tocitem" href="../../performance/">Performance</a></li><li><a class="tocitem" href="../../parallelization/">Parallelization</a></li></ul></li><li><a class="tocitem" href="../../troubleshooting/">Troubleshooting and FAQ</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference-trixi/">Trixi.jl</a></li><li><a class="tocitem" href="../../reference-trixibase/">TrixiBase.jl</a></li><li><a class="tocitem" href="../../reference-trixi2vtk/">Trixi2Vtk.jl</a></li></ul></li><li><a class="tocitem" href="../../changelog/">Changelog</a></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>10 Upwind FD SBP schemes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>10 Upwind FD SBP schemes</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/Trixi.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/trixi-framework/Trixi.jl/blob/main/docs/literate/src/files/upwind_fdsbp.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="upwind_fdsbp"><a class="docs-heading-anchor" href="#upwind_fdsbp">10: Upwind FD SBP schemes</a><a id="upwind_fdsbp-1"></a><a class="docs-heading-anchor-permalink" href="#upwind_fdsbp" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/trixi-framework/Trixi.jl/tutorial_notebooks?filepath=tutorials/notebooks/upwind_fdsbp.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/trixi-framework/Trixi.jl/blob/tutorial_notebooks/tutorials/notebooks/upwind_fdsbp.ipynb"><img src="https://img.shields.io/badge/render-nbviewer-f37726" alt/></a> <a href="https://raw.githubusercontent.com/trixi-framework/Trixi.jl/tutorial_notebooks/tutorials/notebooks/upwind_fdsbp.ipynb"><img src="https://img.shields.io/badge/raw-notebook-4cc61e" alt/></a></p><p>General tensor product SBP methods are supported via the <code>DGMulti</code> solver in a reasonably complete way, see <a href="../DGMulti_2/#DGMulti_2">the previous tutorial</a>. Nevertheless, there is also experimental support for SBP methods with other solver and mesh types.</p><p>The first step is to set up an SBP operator. A classical (central) SBP operator can be created as follows.</p><pre><code class="language-julia hljs">using Trixi
D_SBP = derivative_operator(SummationByPartsOperators.MattssonNordström2004(),
                            derivative_order=1, accuracy_order=2,
                            xmin=0.0, xmax=1.0, N=11)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">SBP first-derivative operator of order 2 on a grid in [0.0, 1.0] using 11 nodes 
and coefficients of Mattsson, Nordström (2004) 
  Summation by parts operators for finite difference approximations of second 
    derivatives. 
  Journal of Computational Physics 199, pp. 503-540.</code></pre><p>Instead of prefixing the source of coefficients <code>MattssonNordström2004()</code>, you can also load the package SummationByPartsOperators.jl. Either way, this yields an object representing the operator efficiently. If you want to compare it to coefficients presented in the literature, you can convert it to a matrix.</p><pre><code class="language-julia hljs">Matrix(D_SBP)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11×11 Matrix{Float64}:
 -10.0  10.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0   0.0
  -5.0   0.0   5.0   0.0   0.0   0.0   0.0   0.0   0.0    0.0   0.0
   0.0  -5.0   0.0   5.0   0.0   0.0   0.0   0.0   0.0    0.0   0.0
   0.0   0.0  -5.0   0.0   5.0   0.0   0.0   0.0   0.0    0.0   0.0
   0.0   0.0   0.0  -5.0   0.0   5.0   0.0   0.0   0.0    0.0   0.0
   0.0   0.0   0.0   0.0  -5.0   0.0   5.0   0.0   0.0    0.0   0.0
   0.0   0.0   0.0   0.0   0.0  -5.0   0.0   5.0   0.0    0.0   0.0
   0.0   0.0   0.0   0.0   0.0   0.0  -5.0   0.0   5.0    0.0   0.0
   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -5.0   0.0    5.0   0.0
   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -5.0    0.0   5.0
   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  -10.0  10.0</code></pre><p>Upwind SBP operators are a concept introduced in 2017 by Ken Mattsson. You can create them as follows.</p><pre><code class="language-julia hljs">D_upw = upwind_operators(SummationByPartsOperators.Mattsson2017,
                         derivative_order=1, accuracy_order=2,
                         xmin=0.0, xmax=1.0, N=11)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Upwind SBP first-derivative operators of order 2 on a grid in [0.0, 1.0] using 11 nodes 
and coefficients of Mattsson2017</code></pre><p>Upwind operators are derivative operators biased towards one direction. The &quot;minus&quot; variants has a bias towards the left side, i.e., it uses values from more nodes to the left than from the right to compute the discrete derivative approximation at a given node (in the interior of the domain). In matrix form, this means more non-zero entries are left from the diagonal.</p><pre><code class="language-julia hljs">Matrix(D_upw.minus)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11×11 Matrix{Float64}:
 -10.0   10.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
 -10.0   10.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
   5.0  -20.0   15.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
   0.0    5.0  -20.0   15.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0    5.0  -20.0   15.0    0.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0    5.0  -20.0   15.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0    5.0  -20.0   15.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0    5.0  -20.0   15.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0    0.0    5.0  -20.0   15.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0    4.0  -16.0   10.0   2.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   20.0  -50.0  30.0</code></pre><p>Analogously, the &quot;plus&quot; variant has a bias towards the right side.</p><pre><code class="language-julia hljs">Matrix(D_upw.plus)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">11×11 Matrix{Float64}:
 -30.0   50.0  -20.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
  -2.0  -10.0   16.0   -4.0    0.0    0.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0  -15.0   20.0   -5.0    0.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0  -15.0   20.0   -5.0    0.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0  -15.0   20.0   -5.0    0.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0  -15.0   20.0   -5.0    0.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0    0.0  -15.0   20.0   -5.0    0.0   0.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0  -15.0   20.0   -5.0   0.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  -15.0   20.0  -5.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  -10.0  10.0
   0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0    0.0  -10.0  10.0</code></pre><p>For more information on upwind SBP operators, please refer to the documentation of <a href="https://github.com/ranocha/SummationByPartsOperators.jl">SummationByPartsOperators.jl</a> and references cited there.</p><p>The basic idea of upwind SBP schemes is to apply a flux vector splitting and use appropriate upwind operators for both parts of the flux. In 1D, this means to split the flux</p><p class="math-container">\[f(u) = f^-(u) + f^+(u)\]</p><p>such that <span>$f^-(u)$</span> is associated with left-going waves and <span>$f^+(u)$</span> with right-going waves. Then, we apply upwind SBP operators <span>$D^-, D^+$</span> with an appropriate upwind bias, resulting in</p><p class="math-container">\[\partial_x f(u) \approx D^+ f^-(u) + D^- f^+(u)\]</p><p>Note that the established notations of upwind operators <span>$D^\pm$</span> and flux splittings <span>$f^\pm$</span> clash. The right-going waves from <span>$f^+$</span> need an operator biased towards their upwind side, i.e., the left side. This upwind bias is provided by the operator <span>$D^-$</span>.</p><p>Many classical flux vector splittings have been developed for finite volume methods and are described in the book &quot;Riemann Solvers and Numerical Methods for Fluid Dynamics: A Practical Introduction&quot; of Eleuterio F. Toro (2009), <a href="https://doi.org/10.1007/b79761">DOI: 10.1007/b79761</a>. One such a well-known splitting provided by Trixi.jl is <a href="../../reference-trixi/#Trixi.splitting_steger_warming-Tuple{Any, Integer, CompressibleEulerEquations1D}"><code>splitting_steger_warming</code></a>.</p><p>Trixi.jl comes with several example setups using upwind SBP methods with flux vector splitting, e.g.,</p><ul><li><a href="https://github.com/trixi-framework/Trixi.jl/blob/main/examples/tree_2d_fdsbp/elixir_euler_vortex.jl"><code>elixir_euler_vortex.jl</code></a></li><li><a href="https://github.com/trixi-framework/Trixi.jl/blob/main/examples/tree_3d_fdsbp/elixir_euler_taylor_green_vortex.jl"><code>elixir_euler_taylor_green_vortex.jl</code></a></li></ul><h2 id="Package-versions"><a class="docs-heading-anchor" href="#Package-versions">Package versions</a><a id="Package-versions-1"></a><a class="docs-heading-anchor-permalink" href="#Package-versions" title="Permalink"></a></h2><p>These results were obtained using the following versions.</p><pre><code class="language-julia hljs">using InteractiveUtils
versioninfo()

using Pkg
Pkg.status([&quot;Trixi&quot;, &quot;SummationByPartsOperators&quot;],
           mode=PKGMODE_MANIFEST)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Julia Version 1.10.4
Commit 48d4fd48430 (2024-06-04 10:41 UTC)
Build Info:
  Official https://julialang.org/ release
Platform Info:
  OS: Linux (x86_64-linux-gnu)
  CPU: 4 × AMD EPYC 7763 64-Core Processor
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-15.0.7 (ORCJIT, znver3)
Threads: 1 default, 0 interactive, 1 GC (on 4 virtual cores)
Environment:
  JULIA_PKG_SERVER_REGISTRY_PREFERENCE = eager
<span class="sgr32"><span class="sgr1">Status</span></span> `~/work/Trixi.jl/Trixi.jl/docs/Manifest.toml`
  <span class="sgr90">[9f78cca6] </span>SummationByPartsOperators v0.5.61
  <span class="sgr90">[a7f1ee26] </span>Trixi v0.7.16-pre `~/work/Trixi.jl/Trixi.jl`</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../DGMulti_2/">« 9 Other SBP schemes (FD, CGSEM) via <code>DGMulti</code> solver</a><a class="docs-footer-nextpage" href="../adding_new_scalar_equations/">11 Adding a new scalar conservation law »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 14 June 2024 14:10">Friday 14 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
